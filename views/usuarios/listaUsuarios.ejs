<!-- Cabeçalho Principal -->
<%- include('../partials/header') %>

<!-- Conteudo do index -->
<main class="container text-center mt-3">
    <h1>Lista de usuários</h1>

        <a href="/usuarios/cadastrar">
            <button class="btn btn-lg btn-primary">
                <i class="bi bi-plus circle"></i>
                Cadastrar
            </button>
        </a>

        <!-- Criando a tabela de acordo com a lista de usuários -->
         <% if (usuarios && usuarios.length > 0) { %>
          <!-- Criando a tabela -->
            <table class="table table-striped table-hover align-middle mt-5">
                <!-- Cabeçalho da tabela -->
                <thead class="table-dark">
                    <!-- Linha da tabela -->
                    <tr class="text-center">
                        <!-- Coluna -->
                        <th scope="col">ID</th>
                        <th scope="col">Usuarios</th>
                        <th scope="col">E-mail</th>
                        <th scope="col">Tipo</th>
                        <th scope="col">Ações</th>
                    </tr>
                </thead>
                <!-- Corpo da tabela -->
                <tbody>
                    <!-- Usando a função forEach para percorrer o array de usuários -->
                    <% usuarios.forEach((usuario) => {%>
                        <tr>
                            <td><%= usuario.id %></td>
                            <td><%= usuario.usuarios %></td>
                            <td><%= usuario.email %></td>
                            <td><%= usuario.tipo %></td>
                            <td>
                                <!-- Botão de editar -->
                                <a href="/usuarios<%= usuarios.id %>">
                                    <button class="btn btn-sm btn-warning me-2">
                                        <i class="bi bi-pencil-square"></i>
                                        Editar
                                    </button>
                                </a>
                                <!-- Botão de excluir -->
                                 <a href="#">
                                    <button class="btn btn-sm btn-danger me-2" onclick="confirmaExclusao('<%= usuario.usuario%>', '<%= usuario.id%>')">
                                        <i class="bi bi-pencil-square"></i>
                                        Excluir
                                    </button>
                                </a>
                            </td>
                        </tr>
                   <% }) %>
                </tbody>
            </table>

            <% } else { %>
                <!-- Mostra uma mensagem caso não tenha nenhum usuário cadastrado -->
             <div class="alert alert-warning text-center mt-5">
                Nenhum usuário cadastrado no momento.
             </div>
         <% } %>

         <!-- Criação do script para função de deletar -->
          <script>
            function confirmaExclusao(nomeUsuario, id) {
                if (confirm(`Deseja realmente excluir o úsuario ${nomeUsuario}`)) {
                    window.location.href = `/usuarios/deletar/${id}`
                }
            }
          </script>

</main>

<!-- Rodape de todas as páginas -->
<%- include('../partials/footer') %>